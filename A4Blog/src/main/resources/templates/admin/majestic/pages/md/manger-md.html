<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/majestic/layout}">
<body>
<section layout:fragment="main">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.2/dist/bootstrap-table.min.css">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.2/dist/bootstrap-table.min.js"></script>

    <div class="content-wrapper">
        <div class="page-header">
            <h3 class="page-title"> Markdown管理 </h3>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Markdown</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Markdown管理</li>
                </ol>
            </nav>
        </div>

        <div class="row">
            <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Hoverable Table</h4>
                        <div class="table-responsive">
                            <table class="table table-bordered text-center"
                                   id="table"
                                   data-toggle="table"
                                   data-pagination-parts=["pageSize","pageList"]
                                   data-method="post"
                                   data-url="/admin/mds"
                                   data-side-pagination="server"
                                   data-response-handler="responseHandler"
                                   data-resizable="true"
                                   data-pagination="true">
                                <thead>
                                <tr class="text-center">
                                    <th data-formatter="detailFormatter" >#</th>
                                    <th data-field="mdId" data-formatter="mdIdFormatter">MD Id</th>
                                    <th data-field="title" >标题</th>
                                    <th data-field="content" data-formatter="contentFormatter">内容</th>
                                    <th data-field="updateTime">修改时间</th>
                                    <th data-field="createTime">创建时间</th>
                                    <th data-formatter="operateFormatter">操作</th>
                                </tr>
                                </thead>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(function() {
            $('#table').bootstrapTable()
        })
        // https://examples.bootstrap-table.com/index.html?bootstrap4#options/pagination-load-more.html
        function onEdit(mdId) {
            window.location.href = "/admin/edit-md?mdId=" + mdId
        }

        function detailFormatter(value, row, index) {
            return index + 1
        }
        function mdIdFormatter(value, row, index) {
            return '<a href="/admin/edit-md?mdId='+row['mdId']+'" >'+value+'</a>'
        }
        function contentFormatter(value, row, index) {
            return value.substring(0,10)+"..."
        }
        function operateFormatter(value, row, index) {
            return [
                '<button type="button" class="btn btn-dark btn-icon-text" onclick="onEdit('+row['mdId']+')">编辑' ,
                '<i class="mdi mdi-file-check btn-icon-append"></i>' ,
                '</button>      ' ,
                '<button type="button" class="btn btn-warning btn-icon-text">删除' ,
                '<i class="mdi mdi-delete-forever btn-icon-append"></i>' ,
                '</button>'
            ].join('')
        }

        function responseHandler(res) {
            let row = {}
            if (res.isOk) {
                row['total'] = 100
                row['rows'] = res.data
                return row
            } else {
                return row
            }
        }

    </script>
</section>
</body>
</html>